@using PagedList.Mvc
@using PagedList
@using MvcOnlineTicariOtomasyon.Models.Siniflar
@model IPagedList<Cariler>

@{
    ViewBag.Title = "Cariler";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<h2 class="mt-3">Cariler</h2>

<div class="card p-3 mb-3">

    <form method="get" action="/Cari/Index" class="row">

        <!-- Arama -->
        <div class="col-md-4">
            <label>Arama</label>
            <input type="text" name="search" value="@ViewBag.Search"
                   class="form-control" placeholder="Ad / Soyad / Mail ara..." />
        </div>

        <!-- Şehir Filtresi -->
        <div class="col-md-4">
            <label>Şehre göre filtrele</label>
            <select name="city" class="form-control">
                <option value="">Tümü</option>

                @foreach (var sehir in ViewBag.Sehirler as List<string>)
                {
                    <option value="@sehir" @(ViewBag.City == sehir ? "selected" : "")>
                        @sehir
                    </option>
                }
            </select>
        </div>

        <!-- Sayfa başına gösterim -->
        <div class="col-md-2">
            <label>Sayfa başı</label>
            <select name="pageSize" class="form-control">
                <option value="5" @(ViewBag.PageSize == 5 ? "selected" : "")>5</option>
                <option value="10" @(ViewBag.PageSize == 10 ? "selected" : "")>10</option>
                <option value="20" @(ViewBag.PageSize == 20 ? "selected" : "")>20</option>
                <option value="50" @(ViewBag.PageSize == 50 ? "selected" : "")>50</option>
            </select>
        </div>

        <!-- Ara -->
        <div class="col-md-2 d-flex align-items-end">
            <button class="btn btn-primary w-100">Filtrele</button>
        </div>
    </form>
</div>


<table class="table table-striped table-bordered">
    <thead>
        <tr>
            <th>Cari ID</th>
            <th>Ad</th>
            <th>Soyad</th>
            <th>Şehir</th>
            <th>Mail</th>
            <th>İşlemler</th>
        </tr>
    </thead>

    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>@item.CariID</td>
                <td>@item.CariAd</td>
                <td>@item.CariSoyad</td>
                <td>@item.CariSehir</td>
                <td>@item.CariMail</td>
                <td>
                    <a href="/Cari/CariSil/@item.CariID" class="btn btn-danger btn-sm">Sil</a>
                    <a href="/Cari/CariGetir/@item.CariID" class="btn btn-warning btn-sm">Güncelle</a>
                    <a href="/Cari/MusteriSatis/@item.CariID" class="btn btn-info btn-sm">Satış Geçmişi</a>
                </td>
            </tr>
        }
    </tbody>
</table>

<div class="text-center">
    @Html.PagedListPager(
      Model,
      page => Url.Action("Index", new
        {
          page,
          search = ViewBag.Search,
          department = ViewBag.Department,
          pageSize = ViewBag.PageSize
      }),
      new PagedListRenderOptions
      {
          Display = PagedListDisplayMode.Always,
          DisplayPageCountAndCurrentLocation = false,
          DisplayItemSliceAndTotal = false,
          PageCountAndCurrentLocationFormat = "Sayfa {0} / {1}",
          ItemSliceAndTotalFormat = "Kayıt {0}-{1} / {2}",
          MaximumPageNumbersToDisplay = 7
      }
  )

</div>

<a href="/Cari/YeniCari/" class="btn btn-primary">Yeni Cari Ekle</a>
