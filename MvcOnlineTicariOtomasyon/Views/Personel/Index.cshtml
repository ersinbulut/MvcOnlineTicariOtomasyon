@using PagedList.Mvc
@using PagedList
@using MvcOnlineTicariOtomasyon.Models.Siniflar
@model IPagedList<Personel>

@{
    ViewBag.Title = "Personel";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<h2 class="mt-3">Personel Listesi</h2>

<div class="card p-3 mb-3">

    <form method="get" action="/Personel/Index" class="row">

        <!-- Arama -->
        <div class="col-md-4">
            <label>Arama</label>
            <input type="text" name="search" value="@ViewBag.Search"
                   class="form-control" placeholder="Ad / Soyad ara..." />
        </div>

        <!-- Departman Filtresi -->
        <div class="col-md-4">
            <label>Departmana göre filtrele</label>
            <select name="department" class="form-control">
                <option value="">Tümü</option>

                @foreach (var d in ViewBag.Departmanlar as List<Departman>)
                {
                    <option value="@d.DepartmanID" @(ViewBag.Department == d.DepartmanID ? "selected" : "")>
                        @d.DepartmanAd
                    </option>
                }
            </select>
        </div>

        <!-- Sayfa başına -->
        <div class="col-md-2">
            <label>Sayfa başı</label>
            <select name="pageSize" class="form-control">
                <option value="5" @(ViewBag.PageSize == 5 ? "selected" : "")>5</option>
                <option value="10" @(ViewBag.PageSize == 10 ? "selected" : "")>10</option>
                <option value="20" @(ViewBag.PageSize == 20 ? "selected" : "")>20</option>
                <option value="50" @(ViewBag.PageSize == 50 ? "selected" : "")>50</option>
            </select>
        </div>

        <!-- Ara -->
        <div class="col-md-2 d-flex align-items-end">
            <button class="btn btn-primary w-100">Filtrele</button>
        </div>

    </form>

</div>


<table class="table table-striped table-bordered">
    <thead>
        <tr>
            <th>ID</th>
            <th>Personel Adı</th>
            <th>Personel Soyadı</th>
            <th>Görsel</th>
            <th>Departman</th>
            <th>Güncelle</th>
            <th>Satışlar</th>
        </tr>
    </thead>

    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>@item.PersonelID</td>
                <td>@item.PersonelAd</td>
                <td>@item.PersonelSoyad</td>
                <td>
                    <img src="@item.PersonelGorsel"
                         style="width:100px;height:50px;object-fit:cover;border-radius:5px;" />
                </td>
                <td>@item.Departman.DepartmanAd</td>

                <td>
                    <a href="/Personel/PersonelGetir/@item.PersonelID" class="btn btn-warning btn-sm">Güncelle</a>
                </td>

                <td>
                    <a href="/Departman/DepartmanPersonelSatis/@item.PersonelID"
                       class="btn btn-info btn-sm">
                        Satışlar
                    </a>
                </td>
            </tr>
        }
    </tbody>
</table>

<div class="text-center">
    @Html.PagedListPager(
      Model,
      page => Url.Action("Index", new
        {
          page,
          search = ViewBag.Search,
          department = ViewBag.Department,
          pageSize = ViewBag.PageSize
      }),
      new PagedListRenderOptions
      {
          Display = PagedListDisplayMode.Always,
          DisplayPageCountAndCurrentLocation = false,
          DisplayItemSliceAndTotal = false,
          PageCountAndCurrentLocationFormat = "Sayfa {0} / {1}",
          ItemSliceAndTotalFormat = "Kayıt {0}-{1} / {2}",
          MaximumPageNumbersToDisplay = 7
      }
  )

</div>

<a href="/Personel/PersonelEkle" class="btn btn-primary">Yeni Personel</a>
